#!/bin/bash
#procs=`ls -d ./proc*`
#procs=$*
#echo 'procs are ' $procs

# copy 0 to each processor
for proc in $procs
do
	rm -rf $proc/0
	cp -rf ./0 $proc/
done

# extract processor boundary and set entry in 0
for proc in $procs
do
    echo != processing proc $proc 
	# extract proc boundary
    procBnds=`grep 'procBoundary' $proc/constant/polyMesh/boundary | xargs`
	
	cd $proc/0
	vars=`ls -d ./*`
	#echo 'var is ' $vars

    # set entries in each variable
	for var in $vars
	do
		#echo !== processing variable $var

		totalLine=`sed -n '$=' $var`
		#echo $totalLine
		sed -i $(($totalLine - 3)),${totalLine}d $var

		for procBnd in $procBnds
		do
			#echo !=== processing procBnd $procBnd

			echo "    $procBnd"                             >> $var
			echo "    {"                                    >> $var
			echo "        type processor;"                  >> $var
			echo '        value  $internalField;'            >> $var
			echo "    }"                                    >> $var
		done
		echo "}"                                            >> $var
		echo ""                                             >> $var
		echo '// ************************************************************************* //' >> $var
	done
	cd ../../
done
