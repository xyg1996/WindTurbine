import sys, json
from PyQt5.QtWidgets import *


class TreeWidget(QTreeWidget):
    def __init__(self, jsonfile):
        super(TreeWidget, self).__init__()

        self.setColumnCount(1)  # 共2列
        self.setHeaderLabels(['材料属性'])
        self.jsonfile = jsonfile

        rootList = []

        if not self.jsonfile == '':
            infodic = {}
            with open (self.jsonfile,"r") as f:
                infodic = json.load(f)
            for key in infodic['materials']:
                root = QTreeWidgetItem()
                # root.setText(0, '材料名')
                root.setText(0, key)
                rootList.append(root)
                # if isinstance(infodic['materials'][key], dict):
                for keykey in infodic['materials'][key]:
                    child = QTreeWidgetItem()
                    # child.setText(0, '参数')
                    child.setText(0, keykey)
                    root.addChild(child)
                    rootList.append(child)
                    if isinstance(infodic['materials'][key][keykey],list):
                        for ii in infodic['materials'][key][keykey]:
                            childchild = QTreeWidgetItem()
                            # child.setText(0, '参数')
                            childchild.setText(0, ii)
                            child.addChild(childchild)
                            rootList.append(child)
                    else:
                        childchild = QTreeWidgetItem()
                        # child.setText(0, '参数')
                        childchild.setText(0, infodic['materials'][key][keykey])
                        child.addChild(childchild)
                        rootList.append(child)

            self.insertTopLevelItems(0, rootList)
        else:
            pass



if __name__ == '__main__':
    app = QApplication(sys.argv)
    win = TreeWidget()
    win.show()
    sys.exit(app.exec_())